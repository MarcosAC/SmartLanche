name: Setup Repository Configuration

on:
  workflow_dispatch:

jobs:
  setup-admin:
    runs-on: ubuntu-latest

    permissions:
      issues: write
      contents: write
      pull-requests: write
      projects: write

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      #
      # -------------------------- LABELS --------------------------
      #
      - name: Criar labels
        uses: EndBug/labeler@v2
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          labels: |
            bug: Problemas e falhas do sistema
            enhancement: Novas funcionalidades
            documentation: Melhorias na documentação
            backlog: Itens planejados
            prioridade-alta: Tarefas urgentes

      #
      # -------------------------- MILESTONES --------------------------
      #
      - name: Criar Milestone Sprint 1
        uses: octokit/request-action@v2.x
        with:
          route: POST /repos/${{ github.repository }}/milestones
          title: Sprint 1 - Setup e Arquitetura
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      - name: Criar Milestone Sprint 2
        uses: octokit/request-action@v2.x
        with:
          route: POST /repos/${{ github.repository }}/milestones
          title: Sprint 2 - Produtos e Estoque
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      - name: Criar Milestone Sprint 3
        uses: octokit/request-action@v2.x
        with:
          route: POST /repos/${{ github.repository }}/milestones
          title: Sprint 3 - Pedidos e Caixa
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      #
      # -------------------------- PROJETO KANBAN --------------------------
      #
      - name: Criar Projeto Kanban
        id: create_project
        uses: octokit/request-action@v2.x
        with:
          route: POST /repos/${{ github.repository }}/projects
          name: SmartLanche - Kanban
          body: Projeto de acompanhamento de desenvolvimento
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      - name: Log do ID do projeto
        run: echo "Projeto criado com ID: ${{ steps.create_project.outputs.data.id }}"

      #
      # -------------------------- COLUNAS --------------------------
      #
      - name: Criar Coluna To Do
        uses: octokit/request-action@v2.x
        with:
          route: POST /projects/${{ steps.create_project.outputs.data.id }}/columns
          name: To Do
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      - name: Criar Coluna Doing
        uses: octokit/request-action@v2.x
        with:
          route: POST /projects/${{ steps.create_project.outputs.data.id }}/columns
          name: Doing
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      - name: Criar Coluna Done
        uses: octokit/request-action@v2.x
        with:
          route: POST /projects/${{ steps.create_project.outputs.data.id }}/columns
          name: Done
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
