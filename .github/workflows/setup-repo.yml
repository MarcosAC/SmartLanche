name: Setup Repository Configuration

on:
  workflow_dispatch:

jobs:
  setup-admin:
    runs-on: ubuntu-latest

    permissions:
      issues: write
      contents: write
      pull-requests: write
      projects: write

    steps:
      - name: Criar Labels
        uses: peter-evans/create-or-update-labels@v1
        with:
          labels: |
            - name: bug
              color: CC0000
              description: Problemas e falhas do sistema
            - name: enhancement
              color: 00CC66
              description: Novas funcionalidades
            - name: documentation
              color: 3366FF
              description: Melhorias na documentação
            - name: backlog
              color: 999999
              description: Itens planejados
            - name: prioridade-alta
              color: FF6600
              description: Tarefas urgentes

      - name: Criar milestones (Sprints)
        uses: octokit/request-action@v2.x
        with:
          route: POST /repos/${{ github.repository }}/milestones
          title: "Sprint 1 - Setup e Arquitetura"
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      - name: Criar Sprint 2
        uses: octokit/request-action@v2.x
        with:
          route: POST /repos/${{ github.repository }}/milestones
          title: "Sprint 2 - Módulo de Produtos e Estoque"
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      - name: Criar Sprint 3
        uses: octokit/request-action@v2.x
        with:
          route: POST /repos/${{ github.repository }}/milestones
          title: "Sprint 3 - Pedidos e Caixa"
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      - name: Criar Projeto Kanban
        id: criar_projeto
        uses: octokit/request-action@v2.x
        with:
          route: POST /user/projects
          name: "SmartLanche - Kanban"
          body: "Projeto de acompanhamento do desenvolvimento"
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      - name: Criar Colunas no Projeto
        uses: octokit/request-action@v2.x
        with:
          route: POST /projects/${{ steps.criar_projeto.outputs.id }}/columns
          name: "To Do"
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      - name: Criar coluna Doing
        uses: octokit/request-action@v2.x
        with:
          route: POST /projects/${{ steps.criar_projeto.outputs.id }}/columns
          name: "Doing"
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      - name: Criar coluna Done
        uses: octokit/request-action@v2.x
        with:
          route: POST /projects/${{ steps.criar_projeto.outputs.id }}/columns
          name: "Done"
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
