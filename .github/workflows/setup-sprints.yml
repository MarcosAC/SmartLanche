name: Create Scrum Sprints
on:
  workflow_dispatch:

jobs:
  create-sprints:
    runs-on: ubuntu-latest

    steps:
      - name: Create milestones
        uses: actions/github-script@v7
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            const today = new Date();
            const sprintLength = 14; // dias
            const totalSprints = 6;

            for (let i = 1; i <= totalSprints; i++) {
              const start = new Date(today);
              start.setDate(start.getDate() + (i - 1) * sprintLength);

              const end = new Date(start);
              end.setDate(end.getDate() + sprintLength);

              try {
                await github.rest.issues.createMilestone({
                  owner: context.repo.owner,
                  repo: context.repo.repo,
                  title: `Sprint ${i}`,
                  due_on: end.toISOString()
                });
              } catch (e) {
                if (e.status !== 422) throw e;
              }
            }
